---
title: "Ubungsblatt 1 Aufgabe 5"
author: "Anatol"
date: "3/20/2022"
output:
  html_document:
    code_folding: hide
    df_print: kable
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    theme: united
    self_contained: yes
    toc: yes
    toc_float: yes
    toc_level: 3
---

```{r, include = FALSE}
library(dplyr)
library(magrittr)
library(flair)
library(pipeR)
library(knitr)
library(rmarkdown)
library(shiny)
library(shinyWidgets)
library(arm)
library(rAmCharts)
library(xfun)
library(car)
colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color, 
      x)
  } else x
}

xfun::pkg_load2(c("htmltools", "mime"))
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{css, echo=FALSE}
.description {
  color: gray;
  font-style: italics;
```

# Aufgabe 5  
```{r}
load("shiw2012.RData")
head(shiw2012)
str(shiw2012)
```

## 5a)
*Sie wollen mit samtlichen oben aufgefuhrten Variablen ein Regressionsmodell schatzen. Zudem interessieren Sie sich brennend fur die prozentuale Veranderung der Konsumausgaben bei einer Erhohung des Einkommens um ein Prozent. Schatzen Sie daher bitte ein geeignetes Modell und berechnen Sie die interessierende Große.*

```{r}
linRegFull <- lm(cons ~ inc + large + south + female + mar, data = shiw2012)
summary(linRegFull)

linRegElas <- lm(log(cons) ~ log(inc) + large + south + female + mar, data = shiw2012)
summary(linRegElas)

```
Bei einer Erhohung des Einkommens um ein Prozent erhohen sich die Konsumausgaben um 0.54%.


## 5b)

*Schatzen Sie bitte nun sowohl die naherungsweise als auch die exakte Semi-Elastizitat der Konsumausgaben bezuglich des Dummys fur das Geschlecht des Haushaltsvorstandes.*
```{r}
100*linRegElas$coefficients[[5]]
100*(exp(linRegElas$coefficients[[5]]) - 1)
```
Wenn Haushaltsvorstand weiblich ist, sinken die Konsumausgaben um 2.68% (näherungsweise um 2.71%)

## 5c)
*Sie mochten nun fur einen konkreten, nicht in der Stichprobe beﬁndlichen, Haushalt die Konsumausgaben prognostizieren. Der betrachtete Haushalt sei groß, verfuge uber ein Einkommen von 30.000 EUR, habe einen unverheirateten und weiblichen Haushaltsvorstand und beﬁnde sich im Norden des Landes. Gehen Sie dabei von einem normalverteilten Storterm aus. Nutzen Sie ein Element der summary des geschatzten Regressionsmodells.*

```{r}
predict(linRegFull, data.frame(inc = 30000, large = 1, south = 0, female = 1, mar = 0))
exp(predict(linRegElas, data.frame(inc = 30000, large = 1, south = 0, female = 1, mar = 0)))

```
Ein Haushalt, der groß ist,  uber ein Einkommen von 30000 EUR verfuge,  einen unverheirateten und weiblichen Haushaltsvorstand habe und sich im Norden des Landes beﬁnde, gibt 23570.96 EUR fur Konsum aus.
